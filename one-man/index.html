<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="icon" type="image/svg+xml" href="https://peithonking.github.io/portfolio-page/images/icon.svg" />
	<title>Population Simulation: The Last Man on Earth</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="style.css">
	<link rel="preconnect" href="https://cdn.jsdelivr.net">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uplot@1.6.27/dist/uPlot.min.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
	<!-- Header -->
	<header class="main-header">
		<div class="container-fluid">
			<div class="header-content">
				<h1 class="header-title">
					<i class="bi bi-graph-up me-2"></i>
					Population Simulation
				</h1>
				<p class="header-subtitle">The Last Man on Earth Scenario</p>
			</div>
		</div>
	</header>

	<!-- Main Content -->
	<main class="main-content">
		<div class="container-fluid">
			<!-- Controls Card -->
			<div class="simulation-card controls-card">
				<div class="card-header">
					<h2 class="card-title">
						<i class="bi bi-sliders me-2"></i>
						Simulation Parameters
					</h2>
					<!-- Mobile-only collapse toggle -->
					<button class="btn btn-link mobile-collapse-toggle" type="button" data-bs-toggle="collapse" 
							data-bs-target="#parametersCollapse" aria-expanded="true" aria-controls="parametersCollapse">
						<i class="bi bi-chevron-up"></i>
					</button>
				</div>
				<div class="collapse show" id="parametersCollapse">
					<div class="card-body">
					<form id="sim-form" autocomplete="off">
						<!-- Initial Population Section -->
						<div class="parameter-section">
							<h3 class="section-title">Initial Population</h3>
							<div class="parameter-grid">

								<div class="parameter-item">
									<label class="parameter-label">
										Initial Females
										<span class="help-icon"
											title="Set the number of initial females as: multiplier × 10^exponent">
											<i class="bi bi-question-circle"></i>
										</span>
									</label>
									<input type="number" id="initial_females_multiplier" min="1" max="99" value="1"
										class="form-control multiplier-input">
								</div>
								<div class="parameter-item">
									<label class="parameter-label" style="visibility:hidden;">Exponent</label>
									<div class="range-container">
										<span class="multiplier-text">× 10^</span>
										<input type="range" id="initial_females_exponent" min="2" max="10" value="6"
											class="form-range">
										<span class="range-value" id="initial_females_exp_val">6</span>
									</div>
								</div>

								<div class="parameter-item">
									<label class="parameter-label" for="initial_males">
										Initial Males
										<span class="help-icon" title="Number of initial males">
											<i class="bi bi-question-circle"></i>
										</span>
									</label>
									<div class="range-container">
										<input type="range" id="initial_males" min="0" max="10" step="1" value="1"
											class="form-range">
										<span class="range-value" id="initial_males_val">1</span>
									</div>
								</div>

								<div class="parameter-item">
									<label class="parameter-label" for="initial_man_age">
										Initial Man Age
										<span class="help-icon"
											title="Age of the first man at the start of the simulation">
											<i class="bi bi-question-circle"></i>
										</span>
									</label>
									<div class="range-container">
										<input type="range" id="initial_man_age" min="0" max="80" step="1" value="20"
											class="form-range">
										<span class="range-value" id="initial_man_age_val">20</span>
									</div>
								</div>
							</div>
						</div>

						<!-- Simulation Settings Section -->
						<div class="parameter-section">
							<h3 class="section-title">Simulation Settings</h3>
							<div class="parameter-grid">
								<div class="parameter-item">
									<label class="parameter-label" for="years">
										Years to Simulate
										<span class="help-icon" title="Number of years to simulate">
											<i class="bi bi-question-circle"></i>
										</span>
									</label>
									<div class="range-container">
										<input type="range" id="years" min="1" max="200" step="1" value="100"
											class="form-range">
										<span class="range-value" id="years_val">100</span>
									</div>
								</div>

								<div class="parameter-item">
									<label class="parameter-label" for="max_age">
										Maximum Age
										<span class="help-icon" title="Maximum age for the simulation">
											<i class="bi bi-question-circle"></i>
										</span>
									</label>
									<div class="range-container">
										<input type="range" id="max_age" min="0" max="100" step="1" value="80"
											class="form-range">
										<span class="range-value" id="max_age_val">80</span>
									</div>
								</div>
							</div>
						</div>

						<!-- Fertility Section -->
						<div class="parameter-section">
							<h3 class="section-title">Fertility Parameters</h3>
							<div class="parameter-grid">
								<div class="parameter-item">
									<label class="parameter-label" for="daily_attempted_fertility">
										Daily Fertility Attempts
										<span class="help-icon"
											title="Each fertile man will try to impregnate these many females each day">
											<i class="bi bi-question-circle"></i>
										</span>
									</label>
									<div class="range-container">
										<input type="range" id="daily_attempted_fertility" min="0" max="10" step="0.1"
											value="1" class="form-range">
										<span class="range-value" id="daily_attempted_fertility_val">1</span>
									</div>
								</div>

								<div class="parameter-item">
									<label class="parameter-label" for="fertility_rate">
										Fertility Success Rate
										<span class="help-icon" title="Probability of successful pregnancy per attempt">
											<i class="bi bi-question-circle"></i>
										</span>
									</label>
									<div class="range-container">
										<input type="range" id="fertility_rate" min="0" max="1" step="0.1" value="0.3"
											class="form-range">
										<span class="range-value" id="fertility_rate_val">0.3</span>
									</div>
								</div>

								<div class="parameter-item fertility-ranges">
									<label class="parameter-label">
										Fertility Age Ranges
										<span class="help-icon" title="Age ranges for fertility">
											<i class="bi bi-question-circle"></i>
										</span>
									</label>
									<div class="age-range-controls">
										<div class="age-range-row">
											<span class="range-label">Female:</span>
											<input type="number" id="female_fertility_min" min="0" max="100" value="18"
												class="form-control age-input">
											<span class="range-separator">to</span>
											<input type="number" id="female_fertility_max" min="0" max="100" value="40"
												class="form-control age-input">
										</div>
										<div class="age-range-row">
											<span class="range-label">Male:</span>
											<input type="number" id="male_fertility_min" min="0" max="100" value="18"
												class="form-control age-input">
											<span class="range-separator">to</span>
											<input type="number" id="male_fertility_max" min="0" max="100" value="45"
												class="form-control age-input">
										</div>
									</div>
								</div>
							</div>
						</div>

						<!-- Mortality Section -->
						<div class="parameter-section">
							<h3 class="section-title">Mortality Parameters</h3>
							<div class="parameter-grid">
								<div class="parameter-item">
									<label class="parameter-label" for="male_birth_loss_rate">
										Male Birth Loss Rate
										<span class="help-icon"
											title="Fraction of male foetus not surviving till birth">
											<i class="bi bi-question-circle"></i>
										</span>
									</label>
									<div class="range-container">
										<input type="range" id="male_birth_loss_rate" min="0" max="1" step="0.1"
											value="0" class="form-range">
										<span class="range-value" id="male_birth_loss_rate_val">0</span>
									</div>
								</div>

								<div class="parameter-item">
									<label class="parameter-label" for="female_birth_loss_rate">
										Female Birth Loss Rate
										<span class="help-icon"
											title="Fraction of female foetus not surviving till birth">
											<i class="bi bi-question-circle"></i>
										</span>
									</label>
									<div class="range-container">
										<input type="range" id="female_birth_loss_rate" min="0" max="1" step="0.1"
											value="0" class="form-range">
										<span class="range-value" id="female_birth_loss_rate_val">0</span>
									</div>
								</div>

								<div class="parameter-item">
									<label class="parameter-label" for="female_death_rate">
										Female Death Rate
										<span class="help-icon"
											title="Annual death rate for females due to random chances">
											<i class="bi bi-question-circle"></i>
										</span>
									</label>
									<div class="range-container">
										<input type="range" id="female_death_rate" min="0" max="0.2" step="0.01"
											value="0.01" class="form-range">
										<span class="range-value" id="female_death_rate_val">0.01</span>
									</div>
								</div>

								<div class="parameter-item">
									<label class="parameter-label" for="male_death_rate">
										Male Death Rate
										<span class="help-icon"
											title="Annual death rate for males due to random chances">
											<i class="bi bi-question-circle"></i>
										</span>
									</label>
									<div class="range-container">
										<input type="range" id="male_death_rate" min="0" max="0.2" step="0.01"
											value="0.01" class="form-range">
										<span class="range-value" id="male_death_rate_val">0.01</span>
									</div>
								</div>
							</div>
						</div>

						<!-- Action Buttons -->
						<div class="action-buttons">
							<button type="button" id="calculate" class="btn btn-primary btn-lg calculate-btn">
								<i class="bi bi-play-fill me-2"></i>
								Run Simulation
							</button>
							<button type="button" id="reset-storage" class="btn btn-outline-secondary reset-btn">
								<i class="bi bi-arrow-clockwise me-2"></i>
								Reset Parameters
							</button>
						</div>
					</form>
					</div>
				</div>
			</div>

			<!-- Results Section -->
			<div class="results-section">
				<!-- Population Chart Card -->
				<div class="simulation-card chart-card">
					<div class="card-header">
						<h2 class="card-title">
							<i class="bi bi-graph-up me-2"></i>
							Population Over Time
						</h2>
					</div>
					<div class="card-body">
						<div id="chart" class="chart-container"></div>
					</div>
				</div>

				<!-- Age Distribution Card -->
				<div class="simulation-card age-chart-card">
					<div class="card-header">
						<h2 class="card-title">
							<i class="bi bi-bar-chart me-2"></i>
							Age Distribution
						</h2>
						<div class="year-selector" id="age-year-slider-row">
							<label for="age-year-slider" class="year-label">Year:</label>
							<div class="year-slider-container">
								<input type="range" id="age-year-slider" min="1" max="1" value="1" step="1"
									class="form-range year-slider">
								<span class="year-value" id="age-year-slider-val">1</span>
							</div>
						</div>
					</div>
					<div class="card-body">
						<div id="age-bar-chart" class="chart-container"></div>
					</div>
				</div>
			</div>
		</div>
	</main>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/uplot@1.6.27/dist/uPlot.iife.min.js"></script>
	<script src="script.js"></script>
</body>

</html>